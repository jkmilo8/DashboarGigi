@model MvcSiteMapProvider.Web.Html.Models.MenuHelperModel
@using System.Web.Mvc.Html
@using BeyondThemes.Bootstrap;
@using MvcSiteMapProvider.Web.Html.Models
@using gigi_Dash_Common.Public.Model;
@using MvcSiteMapProvider;

<ul class="nav sidebar-menu">
    @ShowMenu(Model.Nodes)
</ul>

@helper ShowMenu(IEnumerable<SiteMapNodeModel> menuItems)
{
Dictionary<string, object> openWith =
        new Dictionary<string, object>();

foreach (MODMenuBE item in MODUserLogin.Menus)
{
    <li>
        @if (item.FatherId == 0)
        {
        @Html.Bootstrap().SidebarMenuItem(item.Name, "/"+item.Controller+"/"+ item.Controller, "", item.Action, item.Controller, openWith).Icon(item.Icon).IsDropDown();
    }
        else
        {
        @Html.Bootstrap().SidebarMenuItem(item.Name, "/" + item.Controller + "/" + item.Controller, "", item.Action, item.Controller, openWith).Icon(item.Icon);
    }
    @if (item.FatherId == 0)
        {
            <ul class="submenu" onclick="$('#loading').show();">
                @*@ShowMenu(node.Children)*@
            </ul>
        }
    </li>

}


@*foreach (var node in menuItems.Where(x=> x.Action != "dynamicNodeProviderMenus"))
{
    var nodeclass = "";
    if (node.IsCurrentNode)
    {
        nodeclass = "active";
    }
    if (node.Children.Any(n => n.IsCurrentNode))
    {
        nodeclass = "active open";
    }
    else if (node.Children.Any())
    {
        foreach (var c in node.Children)
        {
            if (c.Children.Any())
            {
                if (c.Children.Any(n => n.IsCurrentNode))
                {
                    nodeclass = "active open";
                }
            }
        }
    }

        <li class="@(!string.IsNullOrEmpty(nodeclass) ? Html.Raw(nodeclass) : null)">
            @if (node.Children.Any())
            {
                @Html.Bootstrap().SidebarMenuItem(node.Title, node.Url, node.Area, node.Action, node.Controller, node.RouteValues).Icon(node.ImageUrl).IsDropDown();
            }
            else
            {
                    @Html.Bootstrap().SidebarMenuItem(node.Title, node.Url, node.Area, node.Action, node.Controller, node.RouteValues).Icon(node.ImageUrl);
            }
            @if (node.Children.Any())
            {
                <ul class="submenu"  onclick="$('#loading').show();">
                    @ShowMenu(node.Children)
                </ul>
            }
        </li>
    }
}*@